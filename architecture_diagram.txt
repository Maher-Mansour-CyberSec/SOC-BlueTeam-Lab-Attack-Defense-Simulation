================================================================================
                    ATTACK SIMULATION & SOC VALIDATION
                         ARCHITECTURE DIAGRAM
================================================================================

                                    INTERNET
                                       │
                                       ▼
                            ┌─────────────────────┐
                            │   EXTERNAL ATTACK   │
                            │      SIMULATION     │
                            │   (Red Team Ops)    │
                            └──────────┬──────────┘
                                       │
                    ┌──────────────────┼──────────────────┐
                    │                  │                  │
                    ▼                  ▼                  ▼
           ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
           │   KALI      │    │  PURPLE     │    │   MISP      │
           │  LINUX      │    │   KALI      │    │   TI PLAT   │
           │  10.0.0.50  │    │  10.0.0.60  │    │  10.0.0.100 │
           │             │    │             │    │             │
           │ • Nmap      │    │ • ELK Stack │    │ • Threat    │
           │ • Hydra     │    │ • Splunk    │    │   Intel     │
           │ • CME       │    │ • Analysis  │    │ • IOC Mgmt  │
           │ • Impacket  │    │   Tools     │    │             │
           │ • Atomic RT │    │             │    │             │
           └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
                  │                  │                  │
                  └──────────────────┼──────────────────┘
                                     │
                                     ▼
================================================================================
                           PERIMETER SECURITY LAYER
================================================================================
                            
                         ┌─────────────────────┐
                         │      pfSENSE        │
                         │    FIREWALL/IDS     │
                         │    10.0.0.1/24      │
                         │                     │
                         │  ┌───────────────┐  │
                         │  │   SURICATA    │  │
                         │  │    IDS/IPS    │  │
                         │  │               │  │
                         │  │ • ET Rules    │  │
                         │  │ • Custom      │  │
                         │  │   Rules       │  │
                         │  │ • File Extraction│
                         │  └───────────────┘  │
                         │                     │
                         │  ┌───────────────┐  │
                         │  │   VPN/ACLs    │  │
                         │  │  • Filtering  │  │
                         │  │  • NAT        │  │
                         │  │  • Logging    │  │
                         │  └───────────────┘  │
                         └──────────┬──────────┘
                                    │
                    ┌───────────────┼───────────────┐
                    │               │               │
                    ▼               ▼               ▼
================================================================================
                         INTERNAL NETWORK (10.0.0.0/24)
================================================================================

        ┌─────────────────┐         ┌─────────────────┐
        │   WINDOWS       │◄───────►│   WINDOWS       │
        │   SERVER 2019   │  SMB    │   10            │
        │   DOMAIN CTRL   │ Kerberos│   WORKSTATION   │
        │   10.0.0.10     │ LDAP    │   10.0.0.20     │
        │                 │ RPC     │                 │
        │ ┌─────────────┐ │         │ ┌─────────────┐ │
        │ │   SYSMON    │ │         │ │   SYSMON    │ │
        │ │  Event IDs: │ │         │ │  Event IDs: │ │
        │ │  • 1  Process│ │         │ │  • 1  Process│ │
        │ │  • 3  Network│ │         │ │  • 3  Network│ │
        │ │  • 10 Access │ │         │ │  • 10 Access │ │
        │ │  • 11 File   │ │         │ │  • 11 File   │ │
        │ └─────────────┘ │         │ └─────────────┘ │
        │                 │         │                 │
        │ ┌─────────────┐ │         │ ┌─────────────┐ │
        │ │  WINDOWS    │ │         │ │  WINDOWS    │ │
        │ │  SECURITY   │ │         │ │  SECURITY   │ │
        │ │  Event IDs: │ │         │ │  Event IDs: │ │
        │ │  • 4624/4625│ │         │ │  • 4624/4625│ │
        │ │  • 4688     │ │         │ │  • 4688     │ │
        │ │  • 4768/4769│ │         │ │  • 4768/4769│ │
        │ └─────────────┘ │         │ └─────────────┘ │
        │                 │         │                 │
        │ ┌─────────────┐ │         │ ┌─────────────┐ │
        │ │ POWER SHELL │ │         │ │ POWER SHELL │ │
        │ │  Event IDs: │ │         │ │  Event IDs: │ │
        │ │  • 400/403  │ │         │ │  • 400/403  │ │
        │ │  • 800      │ │         │ │  • 800      │ │
        │ │  • 4103/4104│ │         │ │  • 4103/4104│ │
        │ └─────────────┘ │         │ └─────────────┘ │
        └────────┬────────┘         └────────┬────────┘
                 │                           │
                 │    ┌─────────────────┐    │
                 │    │      DVWA       │    │
                 │    │  VULNERABLE     │    │
                 │    │    WEB APP      │    │
                 │    │   10.0.0.40     │    │
                 │    │                 │    │
                 │    │ • SQL Injection │    │
                 │    │ • XSS           │    │
                 │    │ • Brute Force   │    │
                 │    └────────┬────────┘    │
                 │             │             │
                 │    ┌────────┴────────┐    │
                 │    │     WEBSRV      │    │
                 │    │   NORMAL WEB    │    │
                 │    │    SERVER       │    │
                 │    │   10.0.0.30     │    │
                 │    └─────────────────┘    │
                 │                           │
                 └───────────┬───────────────┘
                             │
                             ▼
================================================================================
                           TELEMETRY COLLECTION LAYER
================================================================================

                    ┌─────────────────────────┐
                    │      WINLOGBEAT         │
                    │    (Windows Agents)     │
                    │                         │
                    │  • Security.evtx        │
                    │  • Sysmon.evtx          │
                    │  • PowerShell.evtx      │
                    │  • System.evtx          │
                    └───────────┬─────────────┘
                                │
                    ┌───────────┴───────────┐
                    │                       │
                    ▼                       ▼
        ┌─────────────────┐     ┌─────────────────┐
        │   FILEBEAT      │     │   SURICATA      │
        │   (Log Shipper) │     │   EVE.JSON      │
        │                 │     │                 │
        │ • Apache logs   │     │ • Alerts        │
        │ • System logs   │     │ • HTTP          │
        │ • Custom logs   │     │ • DNS           │
        └────────┬────────┘     │ • TLS           │
                 │              └────────┬────────┘
                 │                       │
                 └───────────┬───────────┘
                             │
                             ▼
================================================================================
                              SIEM & ANALYTICS LAYER
================================================================================

              ┌─────────────────────────────────────────┐
              │         ELASTICSEARCH CLUSTER           │
              │           10.0.0.100:9200               │
              │                                         │
              │  ┌─────────────────────────────────┐    │
              │  │         INDICES                 │    │
              │  │                                 │    │
              │  │  • winlogbeat-*                 │    │
              │  │    - Windows events             │    │
              │  │    - Sysmon data                │    │
              │  │                                 │    │
              │  │  • suricata-*                   │    │
              │  │    - IDS alerts                 │    │
              │  │    - Network flows              │    │
              │  │                                 │    │
              │  │  • detection-alerts-*           │    │
              │  │    - Custom detection results   │    │
              │  │                                 │    │
              │  │  • threat-intel-*               │    │
              │  │    - MISP indicators            │    │
              │  │                                 │    │
              │  └─────────────────────────────────┘    │
              │                                         │
              │  ┌─────────────────────────────────┐    │
              │  │      DETECTION ENGINE           │    │
              │  │                                 │    │
              │  │  • Sigma Rules                  │    │
              │  │  • KQL Queries                  │    │
              │  │  • Machine Learning Jobs        │    │
              │  │  • Alert Actions                │    │
              │  └─────────────────────────────────┘    │
              └──────────────────┬──────────────────────┘
                                 │
              ┌──────────────────┼──────────────────┐
              │                  │                  │
              ▼                  ▼                  ▼
    ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
    │     KIBANA      │ │     SPLUNK      │ │    DETECTION    │
    │   10.0.0.100:5601│ │   10.0.0.100:8000│ │    TESTING      │
    │                 │ │                 │ │    FRAMEWORK    │
    │ ┌─────────────┐ │ │ ┌─────────────┐ │ │                 │
    │ │ Dashboards  │ │ │ │ Dashboards  │ │ │ • Automated   │
    │ │ Visualize   │ │ │ │ SPL Queries │ │ │   Validation  │
    │ │ Discover    │ │ │ │ Reports     │ │ │ • Coverage    │
    │ │ Alerting    │ │ │ │ Alerting    │ │ │   Mapping     │
    │ └─────────────┘ │ │ └─────────────┘ │ │ • Gap Analysis│
    └─────────────────┘ └─────────────────┘ └─────────────────┘

================================================================================
                           DETECTION & RESPONSE LAYER
================================================================================

                    ┌─────────────────────────┐
                    │    DETECTION RULES      │
                    │                         │
                    │  ┌─────────────────┐    │
                    │  │  NETWORK-BASED  │    │
                    │  │                 │    │
                    │  │ • Port Scan     │    │
                    │  │ • C2 Detection  │    │
                    │  │ • Data Exfil    │    │
                    │  └─────────────────┘    │
                    │                         │
                    │  ┌─────────────────┐    │
                    │  │  HOST-BASED     │    │
                    │  │                 │    │
                    │  │ • Process Exec  │    │
                    │  │ • LSASS Access  │    │
                    │  │ • Persistence   │    │
                    │  └─────────────────┘    │
                    │                         │
                    │  ┌─────────────────┐    │
                    │  │  AUTH-BASED     │    │
                    │  │                 │    │
                    │  │ • Brute Force   │    │
                    │  │ • Impossible TS │    │
                    │  │ • Priv Esc      │    │
                    │  └─────────────────┘    │
                    └───────────┬─────────────┘
                                │
                                ▼
================================================================================
                         ANALYST INTERACTION LAYER
================================================================================

              ┌─────────────────────────────────────────┐
              │           SOC ANALYST WORKFLOW          │
              │                                         │
              │  ┌─────────────────────────────────┐    │
              │  │         L1 ANALYST              │    │
              │  │                                 │    │
              │  │  1. Alert Triage                │    │
              │  │  2. Initial Investigation       │    │
              │  │  3. IOC Verification            │    │
              │  │  4. Escalation Decision         │    │
              │  │                                 │    │
              │  │  Tools: SIEM, CMDB, TI          │    │
              │  └─────────────────────────────────┘    │
              │                  │                      │
              │                  ▼                      │
              │  ┌─────────────────────────────────┐    │
              │  │         L2 ANALYST              │    │
              │  │                                 │    │
              │  │  1. Deep Investigation          │    │
              │  │  2. Timeline Construction       │    │
              │  │  3. Scope Assessment            │    │
              │  │  4. Containment Execution       │    │
              │  │  5. Forensic Collection         │    │
              │  │                                 │    │
              │  │  Tools: EDR, Forensics, Scripts │    │
              │  └─────────────────────────────────┘    │
              │                  │                      │
              │                  ▼                      │
              │  ┌─────────────────────────────────┐    │
              │  │    DETECTION ENGINEERING        │    │
              │  │                                 │    │
              │  │  • Rule Development             │    │
              │  │  • Gap Remediation              │    │
              │  │  • Coverage Analysis            │    │
              │  │  • False Positive Tuning        │    │
              │  └─────────────────────────────────┘    │
              └─────────────────────────────────────────┘

================================================================================
                         DATA FLOW DIAGRAM
================================================================================

   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
   │   ATTACK    │────►│   TARGET    │────►│   SYSMON    │
   │   TOOLS     │     │   SYSTEMS   │     │   AGENT     │
   └─────────────┘     └─────────────┘     └──────┬──────┘
                                                  │
   ┌─────────────┐     ┌─────────────┐           │
   │   NMAP      │────►│  SURICATA   │◄──────────┘
   │   SCANS     │     │   IDS/IPS   │
   └─────────────┘     └──────┬──────┘
                              │
                              ▼
   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
   │   ELK/      │◄────│  LOGSTASH   │◄────│  BEATS      │
   │   SPLUNK    │     │  PARSING    │     │  AGENTS     │
   └──────┬──────┘     └─────────────┘     └─────────────┘
          │
          ▼
   ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
   │  DETECTION  │────►│   ALERTS    │────►│   SOC       │
   │   ENGINE    │     │   TRIGGERED │     │  ANALYSTS   │
   └─────────────┘     └─────────────┘     └─────────────┘

================================================================================
                      MITRE ATT&CK COVERAGE MAPPING
================================================================================

   TACTIC              │ TECHNIQUE              │ DETECTION SOURCE
   ────────────────────┼────────────────────────┼────────────────────
   Initial Access      │ T1078 Valid Accounts   │ Windows Security
                       │ T1190 Exploit Public   │ Suricata, DVWA logs
                       │        Application     │
   ────────────────────┼────────────────────────┼────────────────────
   Execution           │ T1059.001 PowerShell   │ PowerShell Logging
                       │ T1053.005 Scheduled    │ Windows Security
                       │           Task         │
   ────────────────────┼────────────────────────┼────────────────────
   Persistence         │ T1543.003 Create       │ Windows System
                       │           Service      │
                       │ T1053.005 Scheduled    │ Windows Security
                       │           Task         │
   ────────────────────┼────────────────────────┼────────────────────
   Privilege Escalation│ T1078 Valid Accounts   │ Windows Security
                       │ T1055 Process Injection│ Sysmon Event 8, 25
   ────────────────────┼────────────────────────┼────────────────────
   Defense Evasion     │ T1055 Process Injection│ Sysmon Event 8, 10
                       │ T1027 Obfuscated Files │ PowerShell Logging
   ────────────────────┼────────────────────────┼────────────────────
   Credential Access   │ T1003.001 LSASS Memory │ Sysmon Event 10
                       │ T1003.002 SAM Database │ Windows Security
                       │ T1110 Brute Force      │ Windows Security
   ────────────────────┼────────────────────────┼────────────────────
   Discovery           │ T1087 Account Discovery│ Windows Security
                       │ T1046 Network Service  │ Suricata
                       │           Scanning     │
                       │ T1018 Remote System    │ Windows Security
                       │           Discovery    │
   ────────────────────┼────────────────────────┼────────────────────
   Lateral Movement    │ T1021.002 SMB/Windows  │ Sysmon, Windows
                       │           Admin Shares │ Security
                       │ T1047 WMI              │ Sysmon, Windows
   ────────────────────┼────────────────────────┼────────────────────
   Collection          │ T1005 Data from Local  │ Sysmon Event 11
                       │           System       │
   ────────────────────┼────────────────────────┼────────────────────
   Command and Control │ T1071 Application      │ Suricata
                       │           Layer Protocol│
   ────────────────────┼────────────────────────┼────────────────────
   Exfiltration        │ T1041 Exfiltration Over│ Suricata
                       │           C2 Channel   │
   ────────────────────┼────────────────────────┼────────────────────
   Impact              │ T1490 Inhibit System   │ Windows System
                       │           Recovery     │

================================================================================
                              END OF DIAGRAM
================================================================================
